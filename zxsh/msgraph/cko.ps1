# Demo how to use access token
# GET /v1.0/me/messages
# Host: https://graph.microsoft.com
# Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...

$base_url = "https://graph.microsoft.com"
$sub = "/v1.0/me"


$access_token = "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkxPakJuNG1KOTdEWlBQaHlEaXEyZzNnTTRuVHZQUUk2TTYwS3FvUWp1cGMiLCJhbGciOiJSUzI1NiIsIng1dCI6IkN0VHVoTUptRDVNN0RMZHpEMnYyeDNRS1NSWSIsImtpZCI6IkN0VHVoTUptRDVNN0RMZHpEMnYyeDNRS1NSWSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8xNzM3MDU3NC03MTEwLTQwYzMtYTMxNy0xMmFjM2ViZjllOTYvIiwiaWF0IjoxNTkwOTkyMTM3LCJuYmYiOjE1OTA5OTIxMzcsImV4cCI6MTU5MDk5NjAzNywiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFVUUF1LzhQQUFBQU5vbnRORjNBa3VEeTlMRHJzZmdCaDR4Tk4yU1hsbHZnMWxIYUVsRnFSdGlHcW1ERDlROE1UbGRieE1jVkxmYnVsUGZZS3VHcVRyZ3RBRnRIVmUyVFJnPT0iLCJhbHRzZWNpZCI6IjE6bGl2ZS5jb206MDAwMTE4RTgyOUM5NUUwQiIsImFtciI6WyJwd2QiXSwiYXBwX2Rpc3BsYXluYW1lIjoienhzaCIsImFwcGlkIjoiZDg3N2VmMjctYTExMC00ZTBmLTgyZGQtZTZjOGU1Mzg1YzYyIiwiYXBwaWRhY3IiOiIwIiwiZW1haWwiOiJ6aGl4aWFuQGhvdG1haWwuY29tIiwiZmFtaWx5X25hbWUiOiJPbmciLCJnaXZlbl9uYW1lIjoiWmhpeGlhbiIsImlkcCI6ImxpdmUuY29tIiwiaXBhZGRyIjoiNDIuNjAuMjMuMCIsIm5hbWUiOiJaaGl4aWFuIE9uZyIsIm9pZCI6ImI0ODRmMjA0LTcyYmMtNDc4OC1hOGJhLWEyNzE4MDgyMTdhZCIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzQkZGRDk4NjA1MENEIiwic2NwIjoiTWFpbC5SZWFkIG9wZW5pZCBUYXNrcy5SZWFkIFVzZXIuUmVhZCBVc2VyLlJlYWRXcml0ZSBwcm9maWxlIGVtYWlsIiwic3ViIjoiSFpHZ082dXNwTGRjUGpZbUgxUVAwNmVQZWlGeUF4QWc2MGhvM1BjdHdUQSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJBUyIsInRpZCI6IjE3MzcwNTc0LTcxMTAtNDBjMy1hMzE3LTEyYWMzZWJmOWU5NiIsInVuaXF1ZV9uYW1lIjoibGl2ZS5jb20jemhpeGlhbkBob3RtYWlsLmNvbSIsInV0aSI6ImthMVpKZ0VZSmthZHp3Q1pYclk0QUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCJdLCJ4bXNfc3QiOnsic3ViIjoiYWxCNGFQSS1ROEg2VEZpUW5wNmlJRXhlU2FmUklxZlFnQ2tRaXgwNmtTUSJ9LCJ4bXNfdGNkdCI6MTQ2NTk3NDA5Nn0.hXZZU80VDNnIrGYX6BJ3MeldwhVdDoEZVKG6RDnHchRtzS8N_qotQp3N3gObNMy_uC7D6xhXYTCm-159GwRhJvIT6LFLCvXPEP_YoHibR2BBSlXhwhYCr9qWfmYq7QV-et61pmFM3g3N8-oWt4eSByRJiFdDYzbfu1OtHUmNoPJtpgmZ0f9WHV_hBg_TEBAEhRHHQvWJmz-BaXO_KNt44XRmCTwcMqOM-rjDItNyB2q51xzBYT91uFGfXT8TniZPaefoWnTrbV6l86wDWmcMV__wRyTt9mjnTJWxu0g_l_u5fgVrU_vVeRZJjrEXzddqH0tRKAa-n5XL53YZdGASJA"

$endpoint_url = "$base_url$sub"
$endpoint_url = "https://outlook.office.com/api/v2.0/me/tasks"




$headers = @{ 
    Authorization="Bearer $access_token" 
}


$endpoint_url
$a = Invoke-RestMethod -Uri $endpoint_url -Headers $headers
$a